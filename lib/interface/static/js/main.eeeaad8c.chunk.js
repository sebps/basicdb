(this["webpackJsonpreact-json-editor"]=this["webpackJsonpreact-json-editor"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),o=n(144),i=n(39),s=n.n(i),u=(n(91),n(51)),l=n(24),f=n.n(l),d=n(32),b=n(7),j=n(2),O=n(147),h=n(50),v=n(41),p=n(20),g=n(149),m=n(6),y=n(60),x=n(63),S=n.n(x),w=n(57),C=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=c.a.useState(e),n=Object(b.a)(t,2),a=n[0],r=n[1],o=c.a.useCallback((function(){r((function(e){return!e}))}),[]);return[a,o]},k=n(150),J=n(145),D=n(5),N=function(e){var t=e.title,n=[{key:t,text:t,onRender:function(){return Object(D.jsx)(k.a,{variant:"large",nowrap:!0,block:!0,children:t})}}];return Object(D.jsx)(J.a,{styles:{root:{alignItems:"center"}},ariaLabel:"app title",items:n})},E=(n(153),n(154)),I={iconName:"Filter"},L={margin:"0 15px"},V={alignItems:"center",display:"flex",justifyContent:"center"},B=function(e){var t=e.onClear,n=e.onDownloadClick,a=e.onSaveClick,r=e.onSearch,c=e.isValidJson,o=e.isReadOnly;console.log("rendering tool bar ..."),console.log("is read only : "),console.log(o);var i=[{key:"download",text:"Download Database",ariaLabel:"Grid view",iconProps:{iconName:"Download"},onClick:n,disabled:!c},{key:"save",text:"Save Changes",ariaLabel:"Grid view",iconProps:{iconName:"Save"},onClick:a,disabled:!c||o}];return Object(D.jsxs)(O.a,{horizontal:!0,style:L,children:[Object(D.jsx)(O.a.Item,{style:V,children:Object(D.jsx)(k.a,{variant:"xLarge",block:!0,children:"POCDB"})}),Object(D.jsx)(O.a.Item,{style:V,children:Object(D.jsx)(J.a,{styles:{root:{alignItems:"center"}},items:i,ariaLabel:"json content commands"})}),Object(D.jsx)(O.a.Item,{style:V,children:Object(D.jsx)(E.a,{placeholder:"Filter DB Key",iconProps:I,onClear:function(e){console.log(e),t()},onChange:function(e,n){void 0!==n&&n.length>0?r(n):t()},onSearch:function(e){void 0!==e&&e.length>0?r(e):t()}})})]})},P="1px solid rgb(237, 235, 233)",F=n(148),R=function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a,r,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(F.a)(),a=new Blob([t],{type:"application/json"}),!window.navigator||!window.navigator.msSaveOrOpenBlob){e.next=6;break}window.navigator.msSaveOrOpenBlob(a,n),e.next=22;break;case 6:return e.prev=6,(r=document.createElement("a")).style.display="none",document.body.appendChild(r),e.next=12,window.URL.createObjectURL(a);case 12:c=e.sent,r.href=c,r.download="".concat(n,".json"),r.click(),window.document.body.removeChild(r),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),console.log("Error: fail to download a file.");case 22:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t){return e.apply(this,arguments)}}(),T=function(e){try{return JSON.stringify(JSON.parse(e),null,"\t")}catch(t){return e}},_=function(e){try{return JSON.parse(e)}catch(t){return{}}},A={root:{height:"inherit",borderTop:P,borderRight:P,borderBottom:P}},M=function(e){var t=e.defaultValue,n=e.schemaValue,a=e.title,c=e.path,o=void 0===c?"":c,i=e.isSchemaSampleDataOn,s=e.onChange,u=e.onSave,l=e.success,f=e.error,d=Object(y.b)(),j=C(!1),h=Object(b.a)(j,2),x=h[0],k=h[1],J=Object(r.useState)(!1),E=Object(b.a)(J,2),I=E[0],L=E[1],V=Object(r.useState)(),P=Object(b.a)(V,2),F=P[0],M=P[1],U=Object(r.useState)(),z=Object(b.a)(U,2),W=z[0],G=z[1],q=Object(r.useRef)(null),K=C(!1),Q=Object(b.a)(K,2),H=Q[0],X=Q[1],Y=C(!1),Z=Object(b.a)(Y,2),$=Z[0],ee=Z[1],te=Object(r.useState)(!1),ne=Object(b.a)(te,2),ae=ne[0],re=ne[1];Object(r.useEffect)((function(){var e=t?T(t):void 0;G(e)}),[t]),Object(r.useEffect)((function(){l&&X()}),[l,X]),Object(r.useEffect)((function(){f&&ee()}),[f,ee]);var ce=Object(r.useCallback)((function(){var e=q.current;if(e){e.layout({width:"auto",height:"auto"});var t=e._domElement;if(t){var n=t.getBoundingClientRect(),a=n.width,r=n.height;e.layout({width:a,height:r})}}}),[]),oe=Object(r.useCallback)((function(){null===d||void 0===d||d.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:n?[{uri:window.location.href,fileMatch:["*"],schema:Object(p.a)({},_(n))}]:void 0})}),[n,d]),ie=Object(r.useCallback)((function(){var e;null===(e=q.current)||void 0===e||e.getAction("editor.action.formatDocument").run()}),[]),se=Object(r.useCallback)((function(e){var t=q.current;t&&(t.setValue(e||""),e&&t.getAction("editor.action.formatDocument").run())}),[]);Object(r.useEffect)((function(){se(t)}),[t,se]),Object(r.useEffect)((function(){oe()}),[n,oe]),Object(r.useEffect)((function(){ce()}),[i,ce]),Object(r.useEffect)((function(){x&&ie()}),[x,ie]);var ue=Object(r.useCallback)((function(e){var t,n=e.map((function(e){var t=e.startLineNumber,n=e.message;return"line ".concat(t,": ").concat(n)})),a=null===(t=q.current)||void 0===t?void 0:t.getValue(),r=n.length>0;L(!!a&&!r)}),[]),le=function(e){if(void 0!==t)if(void 0!==e){re(!0);var n=Object(w.flatten)(JSON.parse(t)),a=Object.entries(n).reduce((function(t,n){var a=Object(b.a)(n,2),r=a[0],c=a[1],o=t;return r.startsWith(e)&&(o=Object.assign(o,Object(v.a)({},r,c))),o}),{}),r=Object(w.unflatten)(a),c=r?T(JSON.stringify(r)):void 0;M(c)}else{re(!1);var o=t?T(t):void 0;M(o)}},fe=Object(r.useCallback)((function(e){x&&ie(),s&&s(e)}),[x,ie,s]);return Object(D.jsxs)(O.a,{styles:A,children:[a&&Object(D.jsx)(O.a.Item,{children:Object(D.jsx)(N,{title:a})}),Object(D.jsx)(O.a.Item,{children:Object(D.jsx)(B,{isValidJson:I,isAutoPrettifyOn:x,onClear:function(){le(void 0)},onDownloadClick:function(){var e,t=null===(e=q.current)||void 0===e?void 0:e.getValue();t&&R(t)},onSaveClick:function(){var e,t=null===(e=q.current)||void 0===e?void 0:e.getValue();t&&u&&u(t)},onAutoPrettifyChange:k,onClearClick:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.setValue("")},onMinifyClick:function(){var e=q.current;if(e){var t=function(e){try{return JSON.stringify(JSON.parse(e),null)}catch(t){return e}}(e.getValue());e.setValue(t)}},onPrettifyClick:ie,onUploadClick:function(e){var t=new FileReader;t.onload=function(){var e=t.result;se(e)},t.readAsText(e)},onFixClick:function(){var e=q.current,t=e&&e.getValue(),n=t&&S.a.parse(t),a=n&&T(JSON.stringify(n));e&&e.setValue(a)},onSearch:le,isReadOnly:ae})}),$&&Object(D.jsx)(O.a.Item,{children:Object(D.jsx)(g.a,{onDismiss:function(){return ee()},messageBarType:m.a.error,children:f})}),H&&Object(D.jsx)(O.a.Item,{children:Object(D.jsx)(g.a,{onDismiss:function(){return X()},messageBarType:m.a.success,children:l})}),Object(D.jsx)(O.a,{styles:A,children:Object(D.jsx)(O.a.Item,{grow:!0,align:"stretch",style:{height:"calc(100% - 20vh)"},children:Object(D.jsx)(y.a,{language:"json",path:o,options:{automaticLayout:!0,autoClosingBrackets:"always",autoClosingQuotes:"always",formatOnPaste:!0,formatOnType:!0,scrollBeyondLastLine:!1},onMount:function(e){var n;q.current=e,null===(n=e.getModel())||void 0===n||n.updateOptions({tabSize:2,insertSpaces:!1}),ce(),window.addEventListener("resize",(function(){ce()})),t&&se(T(t))},onChange:fe,beforeMount:function(){return oe()},onValidate:ue,defaultValue:W,value:F})})})]})},U='{ "name": "sample schema", "type": "object", "properties": { "name": { "title": "Name", "type": "string", "description": "Users full name supporting unicode but no emojis.", "maxLength": 20 }, "email": { "title": "Email", "description": "Like a postal address but for computers.", "type": "string", "format": "email" }, "date_of_birth": { "title": "Date Of Birth", "type": "string", "description": "Date of uses birth in the one and only date standard: ISO 8601.", "format": "date", "example": "1990\u201312\u201328" } }, "required": [ "name" ] }',z=n(27),W=n.n(z),G=function(e){function t(e,n){return W.a.isObject(e)?W.a.toPairs(e).reduce((function(e,a){var r=t(a[1],"".concat(n,".").concat(a[0]));return 2!==r.length||W.a.isObject(r[0])||W.a.isObject(r[1])?e.concat(r):e.concat([r])}),[]):[n,e]}return W.a.isObject(e)?W.a.toPairs(e).reduce((function(e,n){var a=t(n[1],n[0]);return 2!==a.length||W.a.isObject(a[0])||W.a.isObject(a[1])?e.concat(a):e.concat([a])}),[]).reduce((function(e,t){var n=Object(b.a)(t,2),a=n[0],r=n[1];return e[a]=r,e}),{}):JSON.stringify(e)};!function(e){e.Schema="Schema",e.InputJson="Input JSON"}(a||(a={}));var q=function(){return{root:{height:"100vh"}}},K={root:{height:"100%"}},Q=function(e){var t=e.isFullWidth;return Object(j.v)({root:[{width:"50%",height:"100%"},t&&{width:"100%",height:"100%"}]})},H=function(){var e=C(!1),t=Object(b.a)(e,1)[0],n=C(!1),c=Object(b.a)(n,2),o=c[0],i=c[1],s=Object(r.useState)(void 0),l=Object(b.a)(s,1)[0],j=Object(r.useState)(void 0),v=Object(b.a)(j,2),p=v[0],g=v[1],m=Object(r.useState)(void 0),y=Object(b.a)(m,2),x=y[0],S=y[1],w=Object(r.useState)(void 0),k=Object(b.a)(w,2),J=k[0],N=k[1],E=function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{fetch("http://127.0.0.1:2222/_database").then((function(e){return e.json()})).catch((function(e){return console.log(e)})).then((function(e){try{g(JSON.stringify(e.value))}catch(t){console.log(t),S(t.toString())}}))}catch(t){console.log(t),S(t.toString())}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://127.0.0.1:2222/_database/".concat(t.split(".").join("/")),{method:"PUT",body:JSON.stringify({value:n})}).then((function(e){return e.json()}));case 3:return a=e.sent,e.abrupt("return",a.statusCode&&200===a.statusCode);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://127.0.0.1:2222/_database/".concat(t.split(".").join("/")),{method:"DELETE"}).then((function(e){return e.json()}));case 3:return n=e.sent,e.abrupt("return",n.statusCode&&200===n.statusCode);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){E()}),[]),Object(r.useEffect)((function(){!t&&o&&i()}),[t,o,i]);return Object(D.jsx)(O.a,{styles:q,children:Object(D.jsx)(O.a,{wrap:!0,horizontal:!0,grow:!0,styles:K,children:Object(D.jsx)(O.a.Item,{styles:Q({isFullWidth:!t}),children:Object(D.jsx)(M,{title:t?a.InputJson:"",path:"input_json.json",schemaValue:o&&!l?U:l,isSchemaSampleDataOn:o,defaultValue:p,onSave:function(e){var t=JSON.parse(e),n=JSON.parse(p),a=Object(h.b)(n,t),r=G(a),c=Object.keys(r).map((function(e){return L(e)})),o=Object(h.a)(n,t),i=G(o),s=Object.keys(i).map((function(e){var t=i[e];return I(e,t)})),l=Object(h.c)(n,t),f=G(l),d=Object.keys(f).map((function(e){var t=i[e];return I(e,t)}));Promise.all([].concat(Object(u.a)(s),Object(u.a)(d),Object(u.a)(c))).then((function(e){e.some((function(e){return!e}))?(console.log("operation error"),S(""),S("Save failure.")):(console.log("operation success"),N(""),N("Save success."))}))},error:x,success:J})})})})},X=function(){return Object(D.jsx)(H,{})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,160)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};s.a.render(Object(D.jsx)(X,{}),document.getElementById("root")),Y(),Object(o.a)()},91:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.eeeaad8c.chunk.js.map