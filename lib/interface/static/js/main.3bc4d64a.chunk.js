(this["webpackJsonpreact-json-editor"]=this["webpackJsonpreact-json-editor"]||[]).push([[0],{103:function(t,e,n){"use strict";n.r(e);var a,r=n(0),c=n.n(r),o=n(145),i=n(39),s=n.n(i),u=(n(91),n(50)),l=n(24),d=n.n(l),f=n(32),b=n(11),j=n(2),h=n(149),O=n(49),p=n(20),v=n(148),m=n(5),g=n(57),y=n(60),w=n.n(y),x=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=c.a.useState(t),n=Object(b.a)(e,2),a=n[0],r=n[1],o=c.a.useCallback((function(){r((function(t){return!t}))}),[]);return[a,o]},S=n(151),k=n(146),C=n(6),D=function(t){var e=t.title,n=[{key:e,text:e,onRender:function(){return Object(C.jsx)(S.a,{variant:"large",nowrap:!0,block:!0,children:e})}}];return Object(C.jsx)(k.a,{styles:{root:{alignItems:"center"}},ariaLabel:"app title",items:n})},J=(n(154),function(t){var e=t.onDownloadClick,n=t.onSaveClick,a=t.isValidJson,r=[{key:"pocdb",text:"POCDB",disabled:!0},{key:"download",text:"Download Database",ariaLabel:"Grid view",iconProps:{iconName:"Download"},onClick:e,disabled:!a},{key:"save",text:"Save Changes",ariaLabel:"Grid view",iconProps:{iconName:"Save"},onClick:n,disabled:!a}];return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(k.a,{styles:{root:{alignItems:"center"}},items:r,ariaLabel:"json content commands",children:Object(C.jsx)(S.a,{variant:"large",block:!0,children:"POCDB"})})})}),E="1px solid rgb(237, 235, 233)",V=n(150),L=function(){var t=Object(f.a)(d.a.mark((function t(e){var n,a,r,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Object(V.a)(),a=new Blob([e],{type:"application/json"}),!window.navigator||!window.navigator.msSaveOrOpenBlob){t.next=6;break}window.navigator.msSaveOrOpenBlob(a,n),t.next=22;break;case 6:return t.prev=6,(r=document.createElement("a")).style.display="none",document.body.appendChild(r),t.next=12,window.URL.createObjectURL(a);case 12:c=t.sent,r.href=c,r.download="".concat(n,".json"),r.click(),window.document.body.removeChild(r),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),console.log("Error: fail to download a file.");case 22:case"end":return t.stop()}}),t,null,[[6,19]])})));return function(e){return t.apply(this,arguments)}}(),N=function(t){try{return JSON.stringify(JSON.parse(t),null,"\t")}catch(e){return t}},B=function(t){try{return JSON.parse(t)}catch(e){return{}}},I={root:{height:"inherit",borderTop:E,borderRight:E,borderBottom:E}},P=function(t){var e=t.defaultValue,n=t.schemaValue,a=t.title,c=t.path,o=void 0===c?"":c,i=t.isSchemaSampleDataOn,s=t.onChange,u=t.onSave,l=t.success,d=t.error,f=Object(g.b)(),j=x(!1),O=Object(b.a)(j,2),y=O[0],S=O[1],k=Object(r.useState)(!1),E=Object(b.a)(k,2),V=E[0],P=E[1],F=Object(r.useRef)(null),T=e?N(e):void 0,R=x(!1),_=Object(b.a)(R,2),A=_[0],M=_[1],U=x(!1),z=Object(b.a)(U,2),G=z[0],W=z[1];Object(r.useEffect)((function(){l&&M()}),[l,M]),Object(r.useEffect)((function(){d&&W()}),[d,W]);var q=Object(r.useCallback)((function(){var t=F.current;if(t){t.layout({width:"auto",height:"auto"});var e=t._domElement;if(e){var n=e.getBoundingClientRect(),a=n.width,r=n.height;t.layout({width:a,height:r})}}}),[]),Q=Object(r.useCallback)((function(){null===f||void 0===f||f.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:n?[{uri:window.location.href,fileMatch:["*"],schema:Object(p.a)({},B(n))}]:void 0})}),[n,f]),H=Object(r.useCallback)((function(){var t;null===(t=F.current)||void 0===t||t.getAction("editor.action.formatDocument").run()}),[]),K=Object(r.useCallback)((function(t){var e=F.current;e&&(e.setValue(t||""),t&&e.getAction("editor.action.formatDocument").run())}),[]);Object(r.useEffect)((function(){K(e)}),[e,K]),Object(r.useEffect)((function(){Q()}),[n,Q]),Object(r.useEffect)((function(){q()}),[i,q]),Object(r.useEffect)((function(){y&&H()}),[y,H]);var X=Object(r.useCallback)((function(t){var e,n=t.map((function(t){var e=t.startLineNumber,n=t.message;return"line ".concat(e,": ").concat(n)})),a=null===(e=F.current)||void 0===e?void 0:e.getValue(),r=n.length>0;P(!!a&&!r)}),[]),Y=Object(r.useCallback)((function(t){y&&H(),s&&s(t)}),[y,H,s]);return Object(C.jsxs)(h.a,{styles:I,children:[a&&Object(C.jsx)(h.a.Item,{children:Object(C.jsx)(D,{title:a})}),Object(C.jsx)(h.a.Item,{children:Object(C.jsx)(J,{isValidJson:V,isAutoPrettifyOn:y,onAutoPrettifyChange:S,onClearClick:function(){var t;return null===(t=F.current)||void 0===t?void 0:t.setValue("")},onDownloadClick:function(){var t,e=null===(t=F.current)||void 0===t?void 0:t.getValue();e&&L(e)},onSaveClick:function(){var t,e=null===(t=F.current)||void 0===t?void 0:t.getValue();e&&u&&u(e)},onMinifyClick:function(){var t=F.current;if(t){var e=function(t){try{return JSON.stringify(JSON.parse(t),null)}catch(e){return t}}(t.getValue());t.setValue(e)}},onPrettifyClick:H,onUploadClick:function(t){var e=new FileReader;e.onload=function(){var t=e.result;K(t)},e.readAsText(t)},onFixClick:function(){var t=F.current,e=t&&t.getValue(),n=e&&w.a.parse(e),a=n&&N(JSON.stringify(n));t&&t.setValue(a)}})}),G&&Object(C.jsx)(h.a.Item,{children:Object(C.jsx)(v.a,{onDismiss:function(){return W()},messageBarType:m.a.error,children:d})}),A&&Object(C.jsx)(h.a.Item,{children:Object(C.jsx)(v.a,{onDismiss:function(){return M()},messageBarType:m.a.success,children:l})}),Object(C.jsx)(h.a,{styles:I,children:Object(C.jsx)(h.a.Item,{grow:!0,align:"stretch",style:{height:"calc(100% - 20vh)"},children:Object(C.jsx)(g.a,{language:"json",path:o,options:{automaticLayout:!0,autoClosingBrackets:"always",autoClosingQuotes:"always",formatOnPaste:!0,formatOnType:!0,scrollBeyondLastLine:!1},onMount:function(t){var n;F.current=t,null===(n=t.getModel())||void 0===n||n.updateOptions({tabSize:2,insertSpaces:!1}),q(),window.addEventListener("resize",(function(){q()})),e&&K(N(e))},onChange:Y,beforeMount:function(){return Q()},onValidate:X,defaultValue:T})})})]})},F='{ "name": "sample schema", "type": "object", "properties": { "name": { "title": "Name", "type": "string", "description": "Users full name supporting unicode but no emojis.", "maxLength": 20 }, "email": { "title": "Email", "description": "Like a postal address but for computers.", "type": "string", "format": "email" }, "date_of_birth": { "title": "Date Of Birth", "type": "string", "description": "Date of uses birth in the one and only date standard: ISO 8601.", "format": "date", "example": "1990\u201312\u201328" } }, "required": [ "name" ] }',T=n(27),R=n.n(T),_=function(t){function e(t,n){return R.a.isObject(t)?R.a.toPairs(t).reduce((function(t,a){var r=e(a[1],"".concat(n,".").concat(a[0]));return 2!==r.length||R.a.isObject(r[0])||R.a.isObject(r[1])?t.concat(r):t.concat([r])}),[]):[n,t]}return R.a.isObject(t)?R.a.toPairs(t).reduce((function(t,n){var a=e(n[1],n[0]);return 2!==a.length||R.a.isObject(a[0])||R.a.isObject(a[1])?t.concat(a):t.concat([a])}),[]).reduce((function(t,e){var n=Object(b.a)(e,2),a=n[0],r=n[1];return t[a]=r,t}),{}):JSON.stringify(t)};!function(t){t.Schema="Schema",t.InputJson="Input JSON"}(a||(a={}));var A=function(){return{root:{height:"100vh"}}},M={root:{height:"100%"}},U=function(t){var e=t.isFullWidth;return Object(j.s)({root:[{width:"50%",height:"100%"},e&&{width:"100%",height:"100%"}]})},z=function(){var t=x(!1),e=Object(b.a)(t,1)[0],n=x(!1),c=Object(b.a)(n,2),o=c[0],i=c[1],s=Object(r.useState)(void 0),l=Object(b.a)(s,1)[0],j=Object(r.useState)(void 0),p=Object(b.a)(j,2),v=p[0],m=p[1],g=Object(r.useState)(void 0),y=Object(b.a)(g,2),w=y[0],S=y[1],k=Object(r.useState)(void 0),D=Object(b.a)(k,2),J=D[0],E=D[1],V=function(){var t=Object(f.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{fetch("http://127.0.0.1:2222/_database").then((function(t){return t.json()})).catch((function(t){return console.log(t)})).then((function(t){try{m(JSON.stringify(t.value))}catch(e){console.log(e),S(e.toString())}}))}catch(e){console.log(e),S(e.toString())}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),L=function(){var t=Object(f.a)(d.a.mark((function t(e,n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("http://127.0.0.1:2222/_database/".concat(e.split(".").join("/")),{method:"PUT",body:JSON.stringify({value:n})}).then((function(t){return t.json()}));case 3:return a=t.sent,t.abrupt("return",a.statusCode&&200===a.statusCode);case 7:return t.prev=7,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}(),N=function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("http://127.0.0.1:2222/_database/".concat(e.split(".").join("/")),{method:"DELETE"}).then((function(t){return t.json()}));case 3:return n=t.sent,t.abrupt("return",n.statusCode&&200===n.statusCode);case 7:return t.prev=7,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){V()}),[]),Object(r.useEffect)((function(){!e&&o&&i()}),[e,o,i]);return Object(C.jsx)(h.a,{styles:A,children:Object(C.jsx)(h.a,{wrap:!0,horizontal:!0,grow:!0,styles:M,children:Object(C.jsx)(h.a.Item,{styles:U({isFullWidth:!e}),children:Object(C.jsx)(P,{title:e?a.InputJson:"",path:"input_json.json",schemaValue:o&&!l?F:l,isSchemaSampleDataOn:o,defaultValue:v,onSave:function(t){var e=JSON.parse(t),n=JSON.parse(v),a=Object(O.b)(n,e),r=_(a),c=Object.keys(r).map((function(t){return N(t)})),o=Object(O.a)(n,e),i=_(o),s=Object.keys(i).map((function(t){var e=i[t];return L(t,e)})),l=Object(O.c)(n,e),d=_(l),f=Object.keys(d).map((function(t){var e=i[t];return L(t,e)}));Promise.all([].concat(Object(u.a)(s),Object(u.a)(f),Object(u.a)(c))).then((function(t){t.some((function(t){return!t}))?(console.log("operation error"),S(""),S("Save failure.")):(console.log("operation success"),E(""),E("Save success."))}))},error:w,success:J})})})})},G=function(){return Object(C.jsx)(z,{})},W=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,159)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))};s.a.render(Object(C.jsx)(G,{}),document.getElementById("root")),W(),Object(o.a)()},91:function(t,e,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.3bc4d64a.chunk.js.map